name = "wemaster-worker-test"
main = "src/index.js"
compatibility_date = "2024-01-01"

[env.test]
name = "wemaster-worker-test"
vars = { ENVIRONMENT = "test" }

[env.staging]
name = "wemaster-worker-staging"
vars = { ENVIRONMENT = "staging" }

[env.production]
name = "wemaster-worker"
vars = { ENVIRONMENT = "production" }

# 环境变量
[vars]
ENVIRONMENT = "test"
DATABASE_URL = "${DATABASE_URL}"
REDIS_URL = "${REDIS_URL}"
JWT_SECRET = "${JWT_SECRET}"
CONFIG_SERVICE_TOKEN = "${CONFIG_SERVICE_TOKEN}"

# KV 命名空间
[[kv_namespaces]]
binding = "CACHE"
id = "abc123def456ghi789"
preview_id = "def456ghi789jkl012"

# D1 数据库
[[d1_databases]]
binding = "DB"
database_name = "wemaster-test-db"
database_id = "abc123-def456-ghi789-jkl012"

# R2 存储桶
[[r2_buckets]]
binding = "STORAGE"
bucket_name = "wemaster-test-worker"

# Secrets (通过 wrangler secret put 设置)
# wrangler secret put STRIPE_SECRET_KEY
# wrangler secret put JWT_SECRET